<h2>Description</h2>

<p>In Stage Four, implement new CLI sub-commands:</p>

<ul>
  <li>To crawl existing blog sites listed in the database's <code>blogs</code> table. Discover new blog posts and insert their entries into the <code>posts</code> table within the database.</li>
  <li>To list all the blog-posts that are in the database given a blog-site as input.</li>
</ul>

<h2>Objectives</h2>

<p>In this stage, you need to implement <code>--crawl</code> sub-command for this CLI. This sub-command should do the following:</p>

<ul>
  <li>Fetch all the blog sites from the blogs table</li>
  <li>Crawl each of the blog site in the watch list, to discover if new blog posts have been added to that blog site.</li>
  <li>Insert an entry into the posts table for every new blog post discovered.</li>
  <li>If new blog posts are discovered for a blog site, update the last_visited column in the blogs table for that blog site with last blog post that was just discovered.</li>
</ul>

<p>In this stage, implement the <code>--crawl</code> sub-command for the CLI, executing the following tasks:</p>

<ul>
  <li>Retrieve all blog sites listed in the 'blogs' table.</li>
  <li>Perform a crawl on each site in the watch list to identify new blog posts.</li>
  <li>Create an entry in the <code>posts</code> table for each newly discovered post.</li>
  <li>If new blog posts are detected for a blog site, update the <code>last_link</code> column in the <code>blogs</code> table corresponding to that specific blog site with the URL of the recently discovered blog post.</li>
</ul>

<p>Additionally, implement sub-command <code>blognotifier listPosts --site</code>, that would take a URL of a blog-site and output all the blog-posts corresponding to that blog-site to <code>stdout</code>.</p>

<p>Please reuse the code you created from the previous stages.</p>

<h2>Examples</h2>

<p>In this stage your program will be tested for the sub-command, <code>--crawl</code>.</p>

<p>Suppose you have the following entries in the <code>blogs</code> table in the database</p>

<table border="1" cellpadding="1" cellspacing="1" style="width: 500px;">
  <thead>
  <tr>
    <th>site</th>
    <th>last_link</th>
  </tr>
  <tr>
    <td>blog1</td>
    <td>post1</td>
  </tr>
  <tr>
    <td>blog2</td>
    <td>post1</td>
  </tr>
  </thead>
</table>

<p>Suppose that the new blog posts have been added to <code>blog1</code> and <code>blog2</code></p>

<p><code>blog1</code> has the following new blog posts:</p>

<ul>
  <li>post_1</li>
  <li>post_2</li>
</ul>

<p><code>blog2</code> has the following new blog posts:</p>

<ul>
  <li>post_a</li>
  <li>post_b</li>
  <li>post_c</li>
</ul>

<p>Â when the command <code>blognotifier --crawl</code> is run, your program must discover the new blog posts for blogs <code>blog1</code>, and <code>blog2</code>, and update the <code>posts</code> table. After the update the <code>posts</code> table must have the following entries</p>

<table border="1" cellpadding="1" cellspacing="1" style="width: 500px;">
  <thead>
  <tr>
    <th>site</th>
    <th>link</th>
  </tr>
  <tr>
    <td>blog1</td>
    <td>post_1</td>
  </tr>
  <tr>
    <td>blog1</td>
    <td>post_2</td>
  </tr>
  <tr>
    <td>blog2</td>
    <td>post_a</td>
  </tr>
  <tr>
    <td>blog2</td>
    <td>post_b</td>
  </tr>
  <tr>
    <td>blog2</td>
    <td>post_c</td>
  </tr>
  </thead>
</table>

<p>And the <code>blogs</code> table must look like the following:</p>

<table border="1" cellpadding="1" cellspacing="1" style="width: 500px;">
  <thead>
  <tr>
    <th>site</th>
    <th>last_link</th>
  </tr>
  <tr>
    <td>blog1</td>
    <td>post_2</td>
  </tr>
  <tr>
    <td>blog2</td>
    <td>post_c</td>
  </tr>
  </thead>
</table>

<p>Additionally your program will be tested for the sub-command, listPosts --site</p>

<p>when the <code>blognotifier listPosts --site blog2</code> command is run your program should list all the blog-posts corresponding to the given input which is <code>blog2</code> in this case. The following output is expected</p>

<pre><code>post_a
post_b
post_c</code></pre>

<p>Please reuse the code from the previous stages. All the sub-commands from the previous stages will also be tested. Specifically we will test the following sub-commands</p>

<ul>
  <li><code>--migrate</code></li>
  <li><code>--explore</code></li>
  <li><code>--list</code></li>
  <li><code>--crawl</code></li>
  <li><code>listPosts --site</code></li>
</ul>